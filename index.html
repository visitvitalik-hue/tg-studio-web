<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>CADRHUB ‚Äî Poster Menu</title>
  <meta name="theme-color" content="#0b0f18" />

  <style>
    :root{
      --bg:#0b0f18;
      --card:#121a2d;
      --card2:#0e1424;
      --text:#eaf0ff;
      --muted:#9aa7c7;
      --muted2:#6e7aa0;
      --line:rgba(255,255,255,.10);
      --shadow: 0 18px 48px rgba(0,0,0,.45);
      --shadow2: 0 12px 24px rgba(0,0,0,.30);
      --accent:#7aa2ff;
      --accent2:#a78bfa;
      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --r:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(122,162,255,.25), transparent 60%),
        radial-gradient(900px 600px at 90% 15%, rgba(167,139,250,.20), transparent 55%),
        radial-gradient(900px 700px at 50% 110%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(180deg, var(--bg), #070a11);
      font: 15px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      overflow-x:hidden;
    }

    .safe-top{ padding-top: env(safe-area-inset-top); }
    .safe-bot{ padding-bottom: env(safe-area-inset-bottom); }

    .wrap{ min-height:100%; display:flex; flex-direction:column; }

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:20;
      background: linear-gradient(180deg, rgba(11,15,24,.92), rgba(11,15,24,.72));
      backdrop-filter: blur(12px);
      border-bottom:1px solid var(--line);
    }
    .topbar-inner{
      display:flex; align-items:center; gap:10px;
      padding: 12px 14px;
    }

    .brand{
      display:flex; align-items:center; gap:10px;
      flex:1; min-width:0;
    }
    .brand a{ text-decoration:none; color:inherit; display:flex; align-items:center; gap:10px; min-width:0; }

    .logo{
      width:34px;height:34px;border-radius:12px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(255,255,255,.25), transparent 55%),
        linear-gradient(135deg, rgba(122,162,255,.95), rgba(167,139,250,.85));
      box-shadow: 0 10px 26px rgba(122,162,255,.18), 0 10px 22px rgba(167,139,250,.12);
      position:relative; overflow:hidden;
      flex:0 0 auto;
    }
    .logo:after{
      content:"";
      position:absolute; inset:-30%;
      background: linear-gradient(120deg, transparent 30%, rgba(255,255,255,.25), transparent 70%);
      transform: rotate(18deg);
      animation: shine 2.8s ease-in-out infinite;
    }
    @keyframes shine{
      0%{ transform: translateX(-30%) rotate(18deg); opacity:.0}
      30%{opacity:.8}
      60%{opacity:.2}
      100%{ transform: translateX(30%) rotate(18deg); opacity:0}
    }

    .brand-title{ display:flex; flex-direction:column; min-width:0; }
    .brand-title b{
      font-size:14px; letter-spacing:.8px; text-transform:uppercase;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand-title small{
      color:var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    .icon-btn{
      border:1px solid var(--line);
      background: rgba(18,26,45,.55);
      color:var(--text);
      border-radius: 14px;
      padding:10px 12px;
      box-shadow: var(--shadow2);
      cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      gap:8px;
      user-select:none;
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
    }
    .icon-btn:active{ transform: translateY(1px) scale(.99); }
    .icon-btn:hover{ border-color: rgba(122,162,255,.35); }
    .dot{ width:8px;height:8px;border-radius:999px;background:var(--good); box-shadow: 0 0 0 4px rgba(34,197,94,.12); }

    /* Hero */
    .hero{ padding: 12px 14px 6px; }
    .hero-card{
      border-radius: var(--r);
      border: 1px solid var(--line);
      background:
        radial-gradient(700px 240px at 15% 0%, rgba(122,162,255,.22), transparent 60%),
        radial-gradient(700px 240px at 85% 30%, rgba(167,139,250,.18), transparent 60%),
        linear-gradient(180deg, rgba(18,26,45,.80), rgba(14,20,36,.82));
      box-shadow: var(--shadow);
      padding: 14px;
      overflow:hidden;
    }
    .pill{
      font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid rgba(122,162,255,.35);
      background: rgba(122,162,255,.12);
      color: rgba(234,240,255,.95);
      width:max-content;
      display:inline-block;
      margin-right:8px;
    }
    .hero h1{ margin: 10px 0 6px; font-size: 18px; line-height:1.15; }
    .hero p{ margin:0; color: var(--muted); font-size: 13px; }

    .hero-actions{ margin-top: 12px; display:flex; gap:10px; flex-wrap:wrap; }
    .btn{
      border:1px solid var(--line);
      background: rgba(18,26,45,.60);
      color: var(--text);
      padding: 11px 12px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: var(--shadow2);
      user-select:none;
      display:flex; align-items:center; gap:10px;
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
      flex:1 1 160px;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn.primary{
      border-color: rgba(122,162,255,.45);
      background:
        radial-gradient(200px 120px at 30% 10%, rgba(122,162,255,.25), transparent 60%),
        linear-gradient(135deg, rgba(122,162,255,.22), rgba(167,139,250,.18));
    }
    .btn .k{
      width:28px;height:28px;border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      flex:0 0 auto;
    }
    .btn small{ color: var(--muted); display:block; margin-top:2px; font-size:11px; }

    /* Search (no shifts) */
    .search{ padding: 10px 14px 0; }
    .searchbox{
      display:flex; gap:10px; align-items:center;
      border:1px solid var(--line);
      background: rgba(14,20,36,.72);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadow2);
      width:100%;
    }
    .searchbox input{
      flex:1;
      min-width: 0;
      border:0; outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .searchbox input::placeholder{ color: rgba(154,167,199,.7); }
    .chipRow{
      display:flex; gap:8px;
      flex:0 0 auto;
      overflow:auto;
      max-width: 45%;
      padding-bottom: 2px;
    }
    .chip{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      flex:0 0 auto;
    }
    .chip.active{
      border-color: rgba(122,162,255,.45);
      background: rgba(122,162,255,.12);
      color: rgba(234,240,255,.95);
    }

    /* Content */
    .content{
      padding: 10px 14px 18px;
      display:flex;
      flex-direction:column;
      gap: 12px;
      flex:1;
    }

    /* Accordion section */
    .section{
      border-radius: var(--r);
      border:1px solid var(--line);
      background: rgba(14,20,36,.70);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .section-toggle{
      width:100%;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding: 12px 12px;
      border:0;
      background: linear-gradient(180deg, rgba(18,26,45,.55), rgba(14,20,36,.35));
      color: var(--text);
      cursor:pointer;
      user-select:none;
    }
    .section-toggle:active{ transform: translateY(1px); }
    .sec-left{ display:flex; flex-direction:column; align-items:flex-start; gap:2px; }
    .section-toggle h2{ margin:0; font-size: 14px; }
    .section-toggle p{ margin:0; color: var(--muted); font-size: 12px; }
    .sec-right{ display:flex; align-items:center; gap:10px; }
    .count{ color: var(--muted2); font-size: 12px; white-space:nowrap; }
    .chev{
      width:30px;height:30px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      transition: transform .18s ease;
    }
    .section.open .chev{ transform: rotate(180deg); }

    .section-body{
      display:none;
      padding: 12px;
      border-top:1px solid rgba(255,255,255,.08);
    }
    .section.open .section-body{ display:block; }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    @media (min-width: 520px){
      .grid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .chipRow{ max-width: 55%; }
    }

    .card{
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(220px 120px at 20% 10%, rgba(122,162,255,.14), transparent 55%),
        linear-gradient(180deg, rgba(18,26,45,.74), rgba(14,20,36,.70));
      padding: 12px;
      cursor:pointer;
      user-select:none;
      min-height: 118px;
      display:flex;
      flex-direction:column;
      gap:8px;
      box-shadow: 0 12px 24px rgba(0,0,0,.25);
      transition: transform .10s ease, border-color .2s ease;
    }
    .card:active{ transform: translateY(1px) scale(.99); }
    .card:hover{ border-color: rgba(122,162,255,.38); }

    .row{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .ico{
      width:34px; height:34px; border-radius: 14px;
      display:flex; align-items:center; justify-content:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      font-size: 16px;
      flex:0 0 auto;
    }
    .badge{
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      white-space:nowrap;
    }
    .card h3{ margin:0; font-size: 13px; line-height:1.15; }
    .card p{ margin:0; color: var(--muted); font-size: 12px; line-height:1.25; }

    .mini{
      margin-top:auto;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding-top:6px;
      border-top:1px dashed rgba(255,255,255,.10);
      color: rgba(234,240,255,.85);
      font-size: 12px;
    }
    .mini code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px;
      color: rgba(234,240,255,.82);
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      padding: 3px 6px;
      border-radius: 10px;
      white-space:nowrap;
    }

    .footer{
      padding: 12px 14px 18px;
      color: var(--muted2);
      font-size: 12px;
      text-align:center;
    }
    .footer b{ color: rgba(234,240,255,.9); }

    /* Modal */
    .modal{
      position:fixed; inset:0; z-index:50;
      display:none;
      place-items:center;
      padding: 16px;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
    }
    .modal.show{ display:grid; }
    .sheet{
      width:min(520px, 100%);
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(700px 260px at 25% 0%, rgba(122,162,255,.22), transparent 60%),
        radial-gradient(700px 260px at 85% 25%, rgba(167,139,250,.18), transparent 60%),
        linear-gradient(180deg, rgba(18,26,45,.94), rgba(14,20,36,.92));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .sheet-head{
      padding: 14px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px;
    }
    .sheet-head h4{ margin:0; font-size:14px; line-height:1.2; }
    .sheet-head p{ margin:4px 0 0; color:var(--muted); font-size:12px; }
    .sheet-body{ padding: 12px 14px; }
    .hint{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding: 10px 12px;
      color: rgba(234,240,255,.86);
      font-size: 12px;
      line-height:1.35;
    }
    .sheet-actions{
      padding: 12px 14px 14px;
      display:flex; gap:10px; flex-wrap:wrap;
      border-top:1px solid rgba(255,255,255,.10);
    }
    .sheet-actions .btn{ flex: 1 1 160px; justify-content:center; }
    .btn.good{
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.12);
    }
    .btn.ghost{ background: rgba(255,255,255,.05); }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      bottom: calc(14px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(10,14,22,.90);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(234,240,255,.95);
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: var(--shadow2);
      z-index:60;
      display:none;
      max-width: min(520px, 92vw);
      font-size: 12px;
    }
    .toast.show{ display:block; animation: pop .18s ease-out; }
    @keyframes pop{ from{ transform: translateX(-50%) translateY(6px); opacity:0 } to{ transform: translateX(-50%) translateY(0); opacity:1 } }
    @media (prefers-reduced-motion: reduce){
      .logo:after{ animation:none }
      .toast.show{ animation:none }
    }
  </style>
</head>

<body>
<div class="wrap safe-top safe-bot">
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <a href="#" id="logoLink" title="–û—Ç–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª/—á–∞—Ç">
          <div class="logo" aria-hidden="true"></div>
          <div class="brand-title">
            <b>CADRHUB</b>
            <small id="subline">–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç–µ—Ä ‚Ä¢ –≤—ã–±–∏—Ä–∞–π —Ä–µ–∂–∏–º</small>
          </div>
        </a>
      </div>

      <button class="icon-btn" id="btnStatus" type="button" title="–°—Ç–∞—Ç—É—Å">
        <span class="dot" id="dot"></span>
        <span id="statusText">TG</span>
      </button>

      <button class="icon-btn" id="btnClose" type="button" title="–ó–∞–∫—Ä—ã—Ç—å">
        ‚úï
      </button>
    </div>
  </div>

  <div class="hero">
    <div class="hero-card">
      <span class="pill">‚ö° Studio Menu</span>
      <span class="pill" style="border-color:rgba(167,139,250,.45);background:rgba(167,139,250,.10)">üéõ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω</span>

      <h1>–í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º ‚Üí –≤–µ—Ä–Ω–∏—Å—å –≤ —á–∞—Ç ‚Üí –æ—Ç–ø—Ä–∞–≤—å –º–µ–¥–∏–∞</h1>
      <p>
        –≠—Ç–æ –≤–∏—Ç—Ä–∏–Ω–∞-–ø–æ—Å—Ç–µ—Ä. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ –±–æ—Ç <b>–≤ —á–∞—Ç–µ</b> –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ/—Ç–µ–∫—Å—Ç –∏ —Å–¥–µ–ª–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
        <br/>–ß—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ ‚Äú—è –≤ –º–∏–Ω–∏-–∞–ø–ø –∂–¥—É, –∞ –±–æ—Ç –ø–∏—à–µ—Ç‚Äù ‚Äî <b>–≤—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ–ª–∞–µ–º –≤ —á–∞—Ç–µ</b>.
      </p>

      <div class="hero-actions">
        <button class="btn primary" id="btnHow" type="button">
          <span class="k">üß≠</span>
          <span><b>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</b><small>3 —à–∞–≥–∞ –±–µ–∑ –ø–æ–¥–≤–æ—Ö–∞</small></span>
        </button>
        <button class="btn" id="btnBackToChat" type="button">
          <span class="k">‚Ü©Ô∏è</span>
          <span><b>–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç</b><small>–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤ –±–æ—Ç–µ</small></span>
        </button>
      </div>
    </div>
  </div>

  <div class="search">
    <div class="searchbox">
      <span style="opacity:.85">üîé</span>
      <input id="q" type="text" placeholder="–ü–æ–∏—Å–∫: –∫—Ä—É–∂–æ–∫, 9:16, –∫–æ–ª–ª–∞–∂, —ç–º–æ–¥–∑–∏, —Ä—É–ª–µ—Ç–∫–∞‚Ä¶" autocomplete="off" />
      <div class="chipRow">
        <span class="chip active" data-chip="all">–í—Å–µ</span>
        <span class="chip" data-chip="video">–í–∏–¥–µ–æ</span>
        <span class="chip" data-chip="grid">–°–µ—Ç–∫–∏</span>
        <span class="chip" data-chip="post">–ü–æ—Å—Ç</span>
        <span class="chip" data-chip="promo">–ê–∫—Ü–∏–∏</span>
      </div>
    </div>
  </div>

  <div class="content" id="content">

    <!-- –ò–ó –í–ò–î–ï–û (7) -->
    <div class="section open" data-section="video">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>üé¨ –ò–∑ –≤–∏–¥–µ–æ</h2>
          <p>–∫—Ä—É–∂–æ–∫ ‚Ä¢ –∞–≤–∞—Ç–∞—Ä ‚Ä¢ —Ñ–æ—Ä–º–∞—Ç—ã ‚Ä¢ —ç—Ñ—Ñ–µ–∫—Ç—ã</p>
        </div>
        <div class="sec-right">
          <span class="count">7</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridVideo"></div>
      </div>
    </div>

    <!-- –°–ï–¢–ö–ò/–≠–ú-–í–ò–î–ï–û (3) -->
    <div class="section" data-section="grid">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>üß© –°–µ—Ç–∫–∏ / —ç–º-–≤–∏–¥–µ–æ</h2>
          <p>3√ó3 ‚Ä¢ 20√ó1 ‚Ä¢ random pack</p>
        </div>
        <div class="sec-right">
          <span class="count">3</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridGrid"></div>
      </div>
    </div>

    <!-- –ö–û–õ–õ–ê–ñ–ò (3) -->
    <div class="section" data-section="collage">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>üñº –ö–æ–ª–ª–∞–∂–∏</h2>
          <p>—Ñ–æ—Ç–æ 2√ó2 ‚Ä¢ —Ñ–æ—Ç–æ 3√ó3 ‚Ä¢ –∏–∑ –≤–∏–¥–µ–æ 2√ó2</p>
        </div>
        <div class="sec-right">
          <span class="count">3</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridCollage"></div>
      </div>
    </div>

    <!-- –ü–û–°–¢–´/–°–¢–ò–õ–ò (6) -->
    <div class="section" data-section="post">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>‚úçÔ∏è –ü–æ—Å—Ç—ã / —Å—Ç–∏–ª–∏</h2>
          <p>INSIDER ‚Ä¢ POV ‚Ä¢ OLD MONEY ‚Ä¢ –º–∏–∫—Å ‚Ä¢ 2 –ø–∞–∫–∞</p>
        </div>
        <div class="sec-right">
          <span class="count">6</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridPost"></div>
      </div>
    </div>

    <!-- –ò–ì–†–´ -->
    <div class="section" data-section="games">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>üéÆ –ò–≥—Ä—ã</h2>
          <p>—Ä—É–ª–µ—Ç–∫–∞ VIP ‚Ä¢ –º–∏–Ω–∏-—á–µ–ª–ª–µ–Ω–¥–∂–∏</p>
        </div>
        <div class="sec-right">
          <span class="count">2</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridGames"></div>
      </div>
    </div>

    <!-- –ó–ê–õ –°–õ–ê–í–´ -->
    <div class="section" data-section="hall">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>üèÜ –ó–∞–ª —Å–ª–∞–≤—ã</h2>
          <p>—Ç–æ–ø –¥–Ω—è ‚Ä¢ –Ω–µ–¥–µ–ª–∏ ‚Ä¢ –º–µ—Å—è—Ü–∞</p>
        </div>
        <div class="sec-right">
          <span class="count">1</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridHall"></div>
      </div>
    </div>

    <!-- –ê–ö–¶–ò–ò / –ê–î–ú–ò–ù -->
    <div class="section" data-section="promo">
      <button class="section-toggle" type="button">
        <div class="sec-left">
          <h2>üî• –ê–∫—Ü–∏–∏ (–∞–¥–º–∏–Ω)</h2>
          <p>VIP –≤—ã–¥–∞—á–∞ ‚Ä¢ –±–∏–ª–µ—Ç-—Ç–∞–π–º–µ—Ä ‚Ä¢ —Ä–æ–∑—ã–≥—Ä—ã—à</p>
        </div>
        <div class="sec-right">
          <span class="count">3</span>
          <span class="chev">‚åÑ</span>
        </div>
      </button>
      <div class="section-body">
        <div class="grid" id="gridPromo"></div>
      </div>
    </div>

  </div>

  <div class="footer safe-bot">
    <div><b>CADRHUB</b> ‚Ä¢ –≤—ã–±–∏—Ä–∞–µ—à—å –∑–¥–µ—Å—å ‚Üí —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ —á–∞—Ç–µ ‚Üí –ø–æ–ª—É—á–∞–µ—à—å ‚Äú–µ—â—ë‚Äù –ø–∞–∫–µ—Ç—ã</div>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="sheet">
    <div class="sheet-head">
      <div>
        <h4 id="mTitle">–†–µ–∂–∏–º</h4>
        <p id="mDesc">–û–ø–∏—Å–∞–Ω–∏–µ</p>
      </div>
      <button class="icon-btn" id="mX" type="button" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
    </div>
    <div class="sheet-body">
      <div class="hint" id="mHint"></div>
      <div style="height:10px"></div>
      <div class="hint" style="border-color:rgba(122,162,255,.24); background:rgba(122,162,255,.06)">
        <b>–í–∞–∂–Ω–æ:</b> –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ –±–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –º–µ–¥–∏–∞ <b>–≤ —á–∞—Ç–µ</b>. –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ ‚Äú–∂–¥—É –≤ –º–∏–Ω–∏-–∞–ø–ø –∏ –Ω–µ –≤–∏–∂—É —Å–æ–æ–±—â–µ–Ω–∏–π‚Äù.
      </div>
    </div>
    <div class="sheet-actions">
      <button class="btn good" id="mGo" type="button">
        <span class="k">‚úÖ</span>
        <span><b>–í—ã–±—Ä–∞—Ç—å</b><small>–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç</small></span>
      </button>
      <button class="btn ghost" id="mStay" type="button">
        <span class="k">üëÄ</span>
        <span><b>–ï—â—ë –ø–æ—Å–º–æ—Ç—Ä—é</b><small>–æ—Å—Ç–∞—Ç—å—Å—è —Ç—É—Ç</small></span>
      </button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
(() => {
  // === CONFIG (—Ç—ã –ø–æ–º–µ–Ω—è–µ—à—å –ø–æ—Ç–æ–º) ===
  const LOGO_URL = ""; // –Ω–∞–ø—Ä–∏–º–µ—Ä: "https://t.me/cadrhub_chat" –∏–ª–∏ "https://t.me/cadrhub"
  const BOT_BACK_HINT = "–í–æ–∑–≤—Ä–∞—â–∞–π—Å—è –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π –º–µ–¥–∏–∞ ‚Äî –±–æ—Ç –≤—Å—ë –ø–æ–π–º—ë—Ç.";

  // --- Telegram WebApp bridge (safe) ---
  const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;

  function toast(msg){
    const el = document.getElementById('toast');
    el.textContent = msg;
    el.classList.add('show');
    clearTimeout(el._t);
    el._t = setTimeout(() => el.classList.remove('show'), 2200);
  }

  function haptic(kind){
    try{
      if(tg && tg.HapticFeedback){
        const HF = tg.HapticFeedback;
        if(kind === 'light') HF.impactOccurred('light');
        else if(kind === 'medium') HF.impactOccurred('medium');
        else HF.notificationOccurred(kind || 'success');
      }
    }catch(e){}
  }

  function setStatus(){
    const dot = document.getElementById('dot');
    const statusText = document.getElementById('statusText');
    if(tg){
      statusText.textContent = 'TG';
      dot.style.background = 'var(--good)';
      try{ tg.ready(); tg.expand(); }catch(e){}
    } else {
      statusText.textContent = 'WEB';
      dot.style.background = 'var(--warn)';
    }
  }

  function openLink(url){
    if(!url) return;
    if(tg){
      try{
        // –¥–ª—è t.me —Å—Å—ã–ª–æ–∫ –ª—É—á—à–µ openTelegramLink
        if(url.startsWith("https://t.me/") && tg.openTelegramLink){
          tg.openTelegramLink(url);
        } else if(tg.openLink){
          tg.openLink(url);
        } else {
          window.open(url, "_blank");
        }
      }catch(e){
        window.open(url, "_blank");
      }
    } else {
      window.open(url, "_blank");
    }
  }

  function sendPayload(payload){
    const str = JSON.stringify(payload);
    if(!tg){
      console.log('sendData:', str);
      toast('–û—Ç–∫—Ä—ã—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª—å');
      return true;
    }
    try{
      tg.sendData(str);
      return true;
    }catch(e){
      toast('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É');
      return false;
    }
  }

  // --- Clickable logo ---
  const logoLink = document.getElementById('logoLink');
  logoLink.addEventListener('click', (e) => {
    e.preventDefault();
    haptic('light');
    if(!LOGO_URL){
      toast('–ü–æ–∫–∞ –Ω–µ—Ç —Å—Å—ã–ª–∫–∏. –î–∞—à—å ‚Äî –≤—Å—Ç–∞–≤–∏–º –≤ LOGO_URL.');
      return;
    }
    openLink(LOGO_URL);
  });

  // --- Data (—Ç–æ—á–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞–∫ —Ç—ã —Å–∫–∞–∑–∞–ª) ---
  const MODES = [
    // VIDEO (7)
    { id:'circle',   section:'video', tag:'video', icon:'‚óØ',  title:'–ö—Ä—É–∂–æ–∫ (Fake Live)', desc:'–ö—Ä—É–∂–æ–∫ ‚Äú–∫–∞–∫ –∂–∏–≤–æ–π‚Äù –∏–∑ —Ç–≤–æ–µ–≥–æ –≤–∏–¥–µ–æ', preview:'‚óØ + ‚úçÔ∏è', needs:'video', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ –≤ —á–∞—Ç–µ. –ü–æ—Ç–æ–º –ø—Ä–µ–¥–ª–æ–∂–∏—Ç ‚Äú–µ—â—ë‚Äù.', badge:'TOP' },
    { id:'avatar',   section:'video', tag:'video', icon:'üë§', title:'Live Avatar', desc:'–í–∏–¥–µ–æ-–∞–≤–∞—Ç–∞—Ä–∫–∞ (–ø–µ—Ç–ª—è)', preview:'üë§ loop', needs:'video', hint:'–õ—É—á—à–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∫ –î–æ–∫—É–º–µ–Ω—Ç.', badge:'PRO' },
    { id:'9_16',     section:'video', tag:'video', icon:'üì±', title:'9:16 (–≤–µ—Ä—Ç–∏–∫–∞–ª—å)', desc:'Shorts/Reels —Ñ–æ—Ä–º–∞—Ç', preview:'9:16', needs:'video', hint:'–°–∫–æ—Ä–æ –¥–æ–±–∞–≤–∏–º ‚Äú—Ä—É–ª—å‚Äù –∫–∞–¥—Ä–∞ (drag/zoom).', badge:'FMT' },
    { id:'16_9',     section:'video', tag:'video', icon:'üñ•', title:'16:9 (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å)', desc:'YouTube/–ø—Ä–µ–≤—å—é/—ç–∫—Ä–∞–Ω', preview:'16:9', needs:'video', hint:'–í–∏–¥–µ–æ –ª—É—á—à–µ –∫–∞–∫ –î–æ–∫—É–º–µ–Ω—Ç.', badge:'FMT' },
    { id:'noir',     section:'video', tag:'video', icon:'üñ§', title:'Noir (—Å—Ç–∏–ª—å)', desc:'–ß/–ë –∫–∏–Ω–æ-–∞—Ç–º–æ—Å—Ñ–µ—Ä–∞', preview:'üñ§ + ‚úçÔ∏è', needs:'video', hint:'–û—Ç–ª–∏—á–Ω–æ —Å –ø–æ—Å—Ç–æ–º INSIDER/POV.', badge:'STYLE' },
    { id:'boomer',   section:'video', tag:'video', icon:'üîÅ', title:'Boomerang', desc:'–ü–µ—Ç–ª—è —Ç—É–¥–∞-–æ–±—Ä–∞—Ç–Ω–æ', preview:'üîÅ', needs:'video', hint:'–í–æ–≤–ª–µ–∫–∞–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ –≤ –ª–µ–Ω—Ç–µ.', badge:'VIRAL' },
    { id:'audio',    section:'video', tag:'video', icon:'üéß', title:'–ê—É–¥–∏–æ (mp3)', desc:'–í—ã—Ç–∞—â–∏—Ç—å –∑–≤—É–∫ –∏–∑ –≤–∏–¥–µ–æ', preview:'mp3', needs:'video', hint:'–î–ª—è –æ–∑–≤—É—á–∫–∏/–ø–æ–¥–∫–∞—Å—Ç–æ–≤.', badge:'UTIL' },

    // GRID (3)
    { id:'grid_3x3', section:'grid',  tag:'grid',  icon:'üß©', title:'–°–µ—Ç–∫–∞ 3√ó3', desc:'–í–∏—Ä—É—Å–Ω–∞—è —Å–µ—Ç–∫–∞', preview:'3√ó3', needs:'video', hint:'1 –≤–∏–¥–µ–æ ‚Üí 9 –ø–ª–∏—Ç–æ–∫.', badge:'VIRAL' },
    { id:'grid_20x1',section:'grid',  tag:'grid',  icon:'‚îÉ',  title:'–õ–µ–Ω—Ç–∞ 20√ó1', desc:'–ü–æ–ª–æ—Å–∞ ‚Äú—Å—Ç–∏–∫–µ—Ä–æ–≤‚Äù', preview:'20√ó1', needs:'video', hint:'1 –≤–∏–¥–µ–æ ‚Üí –Ω–∞–±–æ—Ä.', badge:'PACK' },
    { id:'emoji_rand',section:'grid', tag:'grid',  icon:'üé≤', title:'Random pack (–∏–∑ 20)', desc:'–†–∞–Ω–¥–æ–º–Ω—ã–π –Ω–∞–±–æ—Ä', preview:'üé≤‚Üí20', needs:'video', hint:'–°–æ–±–∏—Ä–∞–µ–º ‚Äú–≤–∞—É‚Äù.', badge:'FUN' },

    // COLLAGE (3)
    { id:'ph_2x2',   section:'collage', tag:'collage', icon:'üñº', title:'–ö–æ–ª–ª–∞–∂ —Ñ–æ—Ç–æ 2√ó2', desc:'4 —Ñ–æ—Ç–æ ‚Üí –æ–¥–∏–Ω –∫–æ–ª–ª–∞–∂', preview:'2√ó2', needs:'photos', hint:'–û—Ç–ø—Ä–∞–≤—å 4 —Ñ–æ—Ç–æ –∞–ª—å–±–æ–º–æ–º.', badge:'EASY' },
    { id:'ph_3x3',   section:'collage', tag:'collage', icon:'üß±', title:'–ö–æ–ª–ª–∞–∂ —Ñ–æ—Ç–æ 3√ó3', desc:'9 —Ñ–æ—Ç–æ ‚Üí –æ–¥–∏–Ω –∫–æ–ª–ª–∞–∂', preview:'3√ó3', needs:'photos', hint:'–û—Ç–ø—Ä–∞–≤—å –¥–æ 9 —Ñ–æ—Ç–æ –∞–ª—å–±–æ–º–æ–º.', badge:'VIRAL' },
    { id:'vid_2x2',  section:'collage', tag:'collage', icon:'üéû', title:'–ö–æ–ª–ª–∞–∂ –∏–∑ –≤–∏–¥–µ–æ', desc:'4 —è—Ä–∫–∏—Ö –∫–∞–¥—Ä–∞', preview:'üéû‚Üí2√ó2', needs:'video', hint:'1 –≤–∏–¥–µ–æ ‚Üí 4 –∫–∞–¥—Ä–∞.', badge:'SMART' },

    // POSTS (6)
    { id:'post_insider', section:'post', tag:'post', icon:'üïµÔ∏è', title:'–ü–æ—Å—Ç: INSIDER', desc:'–°–µ–∫—Ä–µ—Ç–Ω–æ, —É–≤–µ—Ä–µ–Ω–Ω–æ, –≤–æ–≤–ª–µ–∫–∞–µ—Ç', preview:'–∂–∏—Ä–Ω–æ+–∫—Ä—é—á–æ–∫', needs:'text', hint:'–ú–æ–∂–Ω–æ –±–µ–∑ –≤–∏–¥–µ–æ –∏–ª–∏ ‚Äú–ø–æ–¥ –≤–∏–¥–µ–æ‚Äù –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞.', badge:'TEXT' },
    { id:'post_pov',     section:'post', tag:'post', icon:'üé≠', title:'–ü–æ—Å—Ç: POV', desc:'–ö–æ—Ä–æ—Ç–∫–æ, –¥–µ—Ä–∑–∫–æ, —Ü–µ–ø–ª—è–µ—Ç', preview:'POV:', needs:'text', hint:'–õ—É—á—à–µ –≤—Å–µ–≥–æ —Å –∫—Ä—É–∂–∫–æ–º/—ç–º–æ–¥–∑–∏.', badge:'TEXT' },
    { id:'post_old',     section:'post', tag:'post', icon:'üíé', title:'–ü–æ—Å—Ç: OLD MONEY', desc:'–¢–∏—Ö–∞—è —Ä–æ—Å–∫–æ—à—å', preview:'üíé', needs:'text', hint:'–ò–¥–µ–∞–ª—å–Ω–æ —Å Live Avatar/16:9.', badge:'TEXT' },
    { id:'post_mix',     section:'post', tag:'post', icon:'üß™', title:'–ú–∏–∫—Å 2 —Å—Ç–∏–ª–µ–π', desc:'–°–º–µ—à–∞–µ–º –¥–≤–∞ —Å—Ç–∏–ª—è', preview:'A+B', needs:'text', hint:'–í—ã–±–µ—Ä–µ—à—å –¥–≤–∞ ‚Äî —Å–æ–±–µ—Ä—ë–º.', badge:'PRO' },
    { id:'pack_boost',   section:'post', tag:'post', icon:'‚ö°', title:'Boost Pack', desc:'–ö—Ä—É–∂–æ–∫ + –ø–æ—Å—Ç + 1 —ç–º–æ–¥–∑–∏', preview:'‚óØ+‚úçÔ∏è+üß©', needs:'video', hint:'–°—Ä–∞–∑—É ‚Äú–ø–µ—Ä–≤—ã–π –∑–∞—Ö–æ–¥‚Äù + —É–¥–µ—Ä–∂–∞–Ω–∏–µ.', badge:'PACK' },
    { id:'pack_creator', section:'post', tag:'post', icon:'üöÄ', title:'Creator Pack', desc:'9:16 + –æ–±–ª–æ–∂–∫–∞ + –ø–æ—Å—Ç', preview:'üì±+üñº+‚úçÔ∏è', needs:'video', hint:'–°–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç.', badge:'PACK' },
  ];

  const GAMES = [
    { id:'game_roulette', section:'games', tag:'games', icon:'üé∞', title:'–†—É–ª–µ—Ç–∫–∞ VIP', desc:'–ü–æ–π–º–∞–π –±–æ–Ω—É—Å (–µ—Å—Ç—å ZERO)', preview:'üé∞', needs:'none', hint:'–ë–æ—Ç –∫—Ä—É—Ç–∏—Ç ‚Äî –≤—ã–¥–∞—ë—Ç –ø—Ä–∏–∑/–ø—Ä–æ–º–æ.', badge:'HOT' },
    { id:'game_trend',    section:'games', tag:'games', icon:'‚ö°', title:'–¢—Ä–µ–Ω–¥-–º–∏—Å—Å–∏—è', desc:'–ú–∏–Ω–∏-—á–µ–ª–ª–µ–Ω–¥–∂ –Ω–∞ –∞–∫—Ç–∏–≤', preview:'üî•', needs:'none', hint:'–í—ã–ø–æ–ª–Ω–∏–ª ‚Üí –±–æ–Ω—É—Å.', badge:'HYPE' },
  ];

  const HALL = [
    { id:'hall_top', section:'hall', tag:'hall', icon:'üèÜ', title:'–¢–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö', desc:'–¥–µ–Ω—å / –Ω–µ–¥–µ–ª—è / –º–µ—Å—è—Ü', preview:'TOP10', needs:'none', hint:'–ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥.', badge:'LIVE' },
  ];

  const PROMO = [
    { id:'promo_admin_vip', section:'promo', tag:'promo', icon:'üëë', title:'–í—ã–¥–∞—Ç—å VIP', desc:'–¥–µ–Ω—å / –º–µ—Å—è—Ü / –Ω–∞–≤—Å–µ–≥–¥–∞', preview:'VIP', needs:'admin', hint:'–¢–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.', badge:'ADMIN' },
    { id:'promo_ticket', section:'promo', tag:'promo', icon:'üéü', title:'–ë–∏–ª–µ—Ç-—Ç–∞–π–º–µ—Ä', desc:'–∞–∫—Ü–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ 24—á', preview:'24h', needs:'admin', hint:'–¢—ã –≤–∫–ª—é—á–∞–µ—à—å –∫–æ–≥–¥–∞ —Ö–æ—á–µ—à—å.', badge:'ADMIN' },
    { id:'promo_draw', section:'promo', tag:'promo', icon:'üéÅ', title:'–†–æ–∑—ã–≥—Ä—ã—à (—Ä–∞–Ω–¥–æ–º)', desc:'1/3/5 –¥–Ω–µ–π VIP', preview:'1|3|5', needs:'admin', hint:'–°—á–∏—Ç–∞—Ç—å –≤—Å—Ç—É–ø–∏–≤—à–∏—Ö –∏ –≤—ã–±—Ä–∞—Ç—å.', badge:'ADMIN' },
  ];

  function badgeLabel(x){ return x || ''; }

  function makeCard(m){
    const el = document.createElement('div');
    el.className = 'card';
    el.dataset.section = m.section;
    el.dataset.tag = (m.tag || '').toLowerCase();
    el.dataset.title = (m.title + ' ' + m.desc).toLowerCase();

    el.innerHTML = `
      <div class="row">
        <div class="ico">${m.icon}</div>
        <div class="badge">${badgeLabel(m.badge)}</div>
      </div>
      <div>
        <h3>${m.title}</h3>
        <p>${m.desc}</p>
      </div>
      <div class="mini">
        <span>${m.needs === 'video' ? 'üé¨ –í–∏–¥–µ–æ' : m.needs === 'photos' ? 'üñº –§–æ—Ç–æ' : m.needs === 'text' ? '‚úçÔ∏è –¢–µ–∫—Å—Ç' : '‚ú®'}</span>
        <code>${m.preview}</code>
      </div>
    `;
    el.addEventListener('click', () => openModal(m));
    return el;
  }

  const grids = {
    video: document.getElementById('gridVideo'),
    grid: document.getElementById('gridGrid'),
    collage: document.getElementById('gridCollage'),
    post: document.getElementById('gridPost'),
    games: document.getElementById('gridGames'),
    hall: document.getElementById('gridHall'),
    promo: document.getElementById('gridPromo'),
  };

  function renderAll(){
    Object.values(grids).forEach(g => g.innerHTML = '');
    MODES.forEach(m => grids[m.section].appendChild(makeCard(m)));
    GAMES.forEach(m => grids[m.section].appendChild(makeCard(m)));
    HALL.forEach(m => grids[m.section].appendChild(makeCard(m)));
    PROMO.forEach(m => grids[m.section].appendChild(makeCard(m)));
  }

  // --- Accordion toggle ---
  document.querySelectorAll('.section').forEach(sec => {
    const btn = sec.querySelector('.section-toggle');
    btn.addEventListener('click', () => {
      sec.classList.toggle('open');
      haptic('light');
    });
  });

  // --- Chips filter ---
  let chip = 'all';
  document.querySelectorAll('.chip').forEach(c => {
    c.addEventListener('click', () => {
      document.querySelectorAll('.chip').forEach(x => x.classList.remove('active'));
      c.classList.add('active');
      chip = c.dataset.chip;
      applyFilter();
      haptic('light');
    });
  });

  const q = document.getElementById('q');
  q.addEventListener('input', applyFilter);

  function applyFilter(){
    const term = (q.value || '').trim().toLowerCase();
    const cards = document.querySelectorAll('.card');

    cards.forEach(card => {
      const sec = card.dataset.section;
      const hay = card.dataset.title || '';
      const tag = card.dataset.tag || '';
      let ok = true;

      if(chip !== 'all'){
        ok = (sec === chip) || (tag === chip);
      }
      if(ok && term){
        ok = hay.includes(term) || tag.includes(term);
      }
      card.style.display = ok ? '' : 'none';
    });

    // hide empty sections & auto-open sections with hits when searching
    document.querySelectorAll('.section').forEach(sec => {
      const visible = sec.querySelectorAll('.card:not([style*="display: none"])').length;
      sec.style.display = visible ? '' : 'none';

      if(term && visible){
        sec.classList.add('open');
      }
    });
  }

  // --- Modal ---
  const modal = document.getElementById('modal');
  const mTitle = document.getElementById('mTitle');
  const mDesc  = document.getElementById('mDesc');
  const mHint  = document.getElementById('mHint');
  const mX     = document.getElementById('mX');
  const mGo    = document.getElementById('mGo');
  const mStay  = document.getElementById('mStay');
  let current = null;

  function openModal(m){
    current = m;
    mTitle.textContent = m.title;
    mDesc.textContent = m.desc;

    const needText =
      m.needs === 'video'  ? '–ù—É–∂–Ω–æ: <b>1 –≤–∏–¥–µ–æ</b> (–≤ —á–∞—Ç–µ –±–æ—Ç—É).' :
      m.needs === 'photos' ? '–ù—É–∂–Ω–æ: <b>2‚Äì9 —Ñ–æ—Ç–æ</b> (–∞–ª—å–±–æ–º–æ–º –≤ —á–∞—Ç).' :
      m.needs === 'text'   ? '–ù—É–∂–Ω–æ: <b>—Ç–µ–∫—Å—Ç</b> (–≤ —á–∞—Ç–µ –±–æ—Ç—É).' :
      m.needs === 'admin'  ? '–ù—É–∂–Ω–æ: <b>–∞–¥–º–∏–Ω-–¥–æ—Å—Ç—É–ø</b> (–≤ —á–∞—Ç–µ –±–æ—Ç—É).' :
                             '–ù–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏ –≤—ã–±—Ä–∞—Ç—å.';

    mHint.innerHTML = `
      <b>–ü—Ä–µ–≤—å—é:</b> <code>${m.preview}</code><br/><br/>
      ${needText}<br/><br/>
      <b>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</b> ${m.hint}<br/><br/>
      <b>Back:</b> –µ—Å–ª–∏ –ø–µ—Ä–µ–¥—É–º–∞–ª ‚Äî –±–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –∫–Ω–æ–ø–∫—É ‚Äú–ù–∞–∑–∞–¥‚Äù.
    `;

    modal.classList.add('show');
    haptic('medium');
  }

  function closeModal(){
    modal.classList.remove('show');
    current = null;
  }

  mX.onclick = closeModal;
  mStay.onclick = () => { haptic('light'); closeModal(); };
  modal.addEventListener('click', (e) => { if(e.target === modal) closeModal(); });

  mGo.onclick = () => {
    if(!current) return;
    haptic('success');

    // —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π payload –≤ –±–æ—Ç–∞
    const payload = {
      type: 'pick_mode',
      mode: current.id,
      section: current.section,
      title: current.title,
      needs: current.needs
    };

    sendPayload(payload);
    toast(BOT_BACK_HINT);

    // –∑–∞–∫—Ä—ã–≤–∞–µ–º WebApp, —á—Ç–æ–±—ã —é–∑–µ—Ä –≤–∏–¥–µ–ª —á–∞—Ç
    if(tg){
      try{ tg.close(); }catch(e){}
    }
    closeModal();
  };

  // --- Topbar buttons ---
  document.getElementById('btnClose').onclick = () => {
    haptic('light');
    if(tg) { try{ tg.close(); }catch(e){} }
    else toast('–ó–∞–∫—Ä—ã—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram');
  };

  document.getElementById('btnStatus').onclick = () => {
    haptic('light');
    toast(tg ? 'Telegram WebApp –∞–∫—Ç–∏–≤–µ–Ω ‚úÖ' : '–û—Ç–∫—Ä—ã—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (sendData –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è)');
  };

  // --- Hero actions ---
  document.getElementById('btnHow').onclick = () => {
    haptic('light');
    const msg = [
      'CADRHUB: –∫–∞–∫ –Ω–µ –ø—É—Ç–∞—Ç—å—Å—è',
      '1) –í—ã–±–∏—Ä–∞–µ—à—å —Ä–µ–∂–∏–º –≤ –º–∏–Ω–∏-–∞–ø–ø',
      '2) –í–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å –º–µ–¥–∏–∞',
      '3) –ü–æ–ª—É—á–∞–µ—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç + ‚Äú–µ—â—ë‚Äù –ø–∞–∫–µ—Ç—ã',
    ].join('\\n');
    if(tg && tg.showPopup) tg.showPopup({title:'3 —à–∞–≥–∞', message: msg, buttons:[{type:'ok'}]});
    else toast('–í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º ‚Üí –≤–µ—Ä–Ω–∏—Å—å –≤ —á–∞—Ç ‚Üí –æ—Ç–ø—Ä–∞–≤—å –º–µ–¥–∏–∞');
  };

  document.getElementById('btnBackToChat').onclick = () => {
    haptic('light');
    if(tg) { try{ tg.close(); }catch(e){} }
    else toast('–≠—Ç–æ –∫–Ω–æ–ø–∫–∞ –¥–ª—è Telegram');
  };

  // init
  setStatus();
  renderAll();
  applyFilter();
})();
</script>
</body>
</html>
