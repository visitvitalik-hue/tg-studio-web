<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>CADRHUB Studio ‚Äî Poster Menu</title>
  <meta name="theme-color" content="#0b0f18" />
  <style>
    :root{
      --bg:#0b0f18;
      --bg2:#0f1626;
      --card:#121a2d;
      --card2:#0e1424;
      --text:#eaf0ff;
      --muted:#9aa7c7;
      --muted2:#6e7aa0;
      --line:rgba(255,255,255,.08);
      --glow:rgba(140,170,255,.35);
      --accent:#7aa2ff;
      --accent2:#a78bfa;
      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;

      --r:18px;
      --shadow: 0 18px 48px rgba(0,0,0,.45);
      --shadow2: 0 12px 24px rgba(0,0,0,.35);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(122,162,255,.25), transparent 60%),
        radial-gradient(900px 600px at 90% 15%, rgba(167,139,250,.20), transparent 55%),
        radial-gradient(900px 700px at 50% 110%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(180deg, var(--bg), #070a11);
      font: 15px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      letter-spacing:.2px;
      overflow-x:hidden;
    }

    /* Safe areas */
    .safe-top{ padding-top: env(safe-area-inset-top); }
    .safe-bot{ padding-bottom: env(safe-area-inset-bottom); }

    .wrap{
      min-height:100%;
      display:flex;
      flex-direction:column;
    }

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:20;
      background: linear-gradient(180deg, rgba(11,15,24,.92), rgba(11,15,24,.70));
      backdrop-filter: blur(12px);
      border-bottom:1px solid var(--line);
    }
    .topbar-inner{
      display:flex; align-items:center; gap:10px;
      padding: 12px 14px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      flex:1;
      min-width:0;
    }
    .logo{
      width:34px;height:34px;border-radius:12px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(255,255,255,.25), transparent 55%),
        linear-gradient(135deg, rgba(122,162,255,.95), rgba(167,139,250,.85));
      box-shadow: 0 10px 26px rgba(122,162,255,.18), 0 10px 22px rgba(167,139,250,.12);
      position:relative;
      overflow:hidden;
    }
    .logo:after{
      content:"";
      position:absolute; inset:-30%;
      background: linear-gradient(120deg, transparent 30%, rgba(255,255,255,.25), transparent 70%);
      transform: rotate(18deg);
      animation: shine 2.8s ease-in-out infinite;
    }
    @keyframes shine{
      0%{ transform: translateX(-30%) rotate(18deg); opacity:.0}
      30%{opacity:.8}
      60%{opacity:.2}
      100%{ transform: translateX(30%) rotate(18deg); opacity:0}
    }

    .brand-title{
      display:flex; flex-direction:column; min-width:0;
    }
    .brand-title b{
      font-size:14px; letter-spacing:.8px;
      text-transform:uppercase;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand-title small{
      color:var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    .icon-btn{
      border:1px solid var(--line);
      background: rgba(18,26,45,.55);
      color:var(--text);
      border-radius: 14px;
      padding:10px 12px;
      box-shadow: var(--shadow2);
      cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      gap:8px;
      user-select:none;
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
    }
    .icon-btn:active{ transform: translateY(1px) scale(.99); }
    .icon-btn:hover{ border-color: rgba(122,162,255,.35); }
    .icon-btn .dot{
      width:8px;height:8px;border-radius:999px;background:var(--good);
      box-shadow: 0 0 0 4px rgba(34,197,94,.12);
    }

    /* Header hero */
    .hero{
      padding: 14px 14px 6px;
    }
    .hero-card{
      border-radius: var(--r);
      border: 1px solid var(--line);
      background:
        radial-gradient(700px 240px at 15% 0%, rgba(122,162,255,.22), transparent 60%),
        radial-gradient(700px 240px at 85% 30%, rgba(167,139,250,.18), transparent 60%),
        linear-gradient(180deg, rgba(18,26,45,.80), rgba(14,20,36,.82));
      box-shadow: var(--shadow);
      padding: 14px;
      position:relative;
      overflow:hidden;
    }
    .hero-card:before{
      content:"";
      position:absolute; inset: -1px;
      background: radial-gradient(800px 280px at 30% 10%, rgba(122,162,255,.20), transparent 60%);
      pointer-events:none;
    }
    .hero-top{
      display:flex; align-items:flex-start; gap:10px;
    }
    .pill{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(122,162,255,.35);
      background: rgba(122,162,255,.12);
      color: rgba(234,240,255,.95);
      width:max-content;
    }
    .hero h1{
      margin: 8px 0 6px;
      font-size: 18px;
      line-height:1.15;
      letter-spacing:.2px;
    }
    .hero p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
    }

    .hero-actions{
      margin-top: 12px;
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .btn{
      border:1px solid var(--line);
      background: rgba(18,26,45,.60);
      color: var(--text);
      padding: 11px 12px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: var(--shadow2);
      user-select:none;
      display:flex; align-items:center; gap:10px;
      transition: transform .08s ease, border-color .2s ease, background .2s ease;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }
    .btn.primary{
      border-color: rgba(122,162,255,.45);
      background:
        radial-gradient(200px 120px at 30% 10%, rgba(122,162,255,.25), transparent 60%),
        linear-gradient(135deg, rgba(122,162,255,.22), rgba(167,139,250,.18));
    }
    .btn .k{
      width:28px;height:28px;border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
    }
    .btn small{ color: var(--muted); display:block; margin-top:2px; font-size:11px; }

    /* Search */
    .search{
      padding: 10px 14px 0;
    }
    .searchbox{
      display:flex; gap:10px; align-items:center;
      border:1px solid var(--line);
      background: rgba(14,20,36,.72);
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadow2);
    }
    .searchbox input{
      flex:1;
      border:0; outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .searchbox input::placeholder{ color: rgba(154,167,199,.7); }
    .chip{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
    }
    .chip.active{
      border-color: rgba(122,162,255,.45);
      background: rgba(122,162,255,.12);
      color: rgba(234,240,255,.95);
    }

    /* Sections */
    .content{
      padding: 10px 14px 18px;
      display:flex;
      flex-direction:column;
      gap: 14px;
      flex:1;
    }

    .section{
      border-radius: var(--r);
      border:1px solid var(--line);
      background: rgba(14,20,36,.70);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .section-head{
      padding: 12px 12px 10px;
      display:flex; justify-content:space-between; align-items:flex-end; gap:10px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(18,26,45,.55), rgba(14,20,36,.35));
    }
    .section-head h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.2px;
    }
    .section-head p{
      margin: 2px 0 0;
      color: var(--muted);
      font-size: 12px;
    }
    .count{
      color: var(--muted2);
      font-size: 12px;
      white-space:nowrap;
    }

    /* Cards grid */
    .grid{
      padding: 12px;
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    @media (min-width: 520px){
      .grid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }

    .card{
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(220px 120px at 20% 10%, rgba(122,162,255,.14), transparent 55%),
        linear-gradient(180deg, rgba(18,26,45,.74), rgba(14,20,36,.70));
      padding: 12px;
      cursor:pointer;
      user-select:none;
      position:relative;
      overflow:hidden;
      transition: transform .10s ease, border-color .2s ease, background .2s ease;
      min-height: 118px;
      display:flex;
      flex-direction:column;
      gap:8px;
      box-shadow: 0 12px 24px rgba(0,0,0,.25);
    }
    .card:active{ transform: translateY(1px) scale(.99); }
    .card:hover{ border-color: rgba(122,162,255,.38); }

    .card .row{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    .badge{
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      white-space:nowrap;
    }
    .ico{
      width:34px; height:34px; border-radius: 14px;
      display:flex; align-items:center; justify-content:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      font-size: 16px;
      flex:0 0 auto;
    }
    .card h3{
      margin:0;
      font-size: 13px;
      line-height:1.15;
    }
    .card p{
      margin:0;
      color: var(--muted);
      font-size: 12px;
      line-height:1.25;
    }
    .mini{
      margin-top:auto;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding-top:6px;
      border-top:1px dashed rgba(255,255,255,.10);
      color: rgba(234,240,255,.85);
      font-size: 12px;
    }
    .mini code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 11px;
      color: rgba(234,240,255,.82);
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      padding: 3px 6px;
      border-radius: 10px;
      white-space:nowrap;
    }

    /* Footer */
    .footer{
      padding: 12px 14px 18px;
      color: var(--muted2);
      font-size: 12px;
      text-align:center;
    }
    .footer b{ color: rgba(234,240,255,.9); }

    /* Modal */
    .modal{
      position:fixed; inset:0; z-index:50;
      display:none;
      place-items:center;
      padding: 16px;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
    }
    .modal.show{ display:grid; }
    .sheet{
      width:min(520px, 100%);
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(700px 260px at 25% 0%, rgba(122,162,255,.22), transparent 60%),
        radial-gradient(700px 260px at 85% 25%, rgba(167,139,250,.18), transparent 60%),
        linear-gradient(180deg, rgba(18,26,45,.94), rgba(14,20,36,.92));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .sheet-head{
      padding: 14px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px;
    }
    .sheet-head h4{ margin:0; font-size:14px; line-height:1.2; }
    .sheet-head p{ margin:4px 0 0; color:var(--muted); font-size:12px; }
    .sheet-body{ padding: 12px 14px; }
    .hint{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding: 10px 12px;
      color: rgba(234,240,255,.86);
      font-size: 12px;
      line-height:1.35;
    }
    .sheet-actions{
      padding: 12px 14px 14px;
      display:flex; gap:10px; flex-wrap:wrap;
      border-top:1px solid rgba(255,255,255,.10);
    }
    .sheet-actions .btn{ flex: 1 1 160px; justify-content:center; }
    .btn.good{
      border-color: rgba(34,197,94,.35);
      background: rgba(34,197,94,.12);
    }
    .btn.ghost{
      background: rgba(255,255,255,.05);
    }

    /* Small toast */
    .toast{
      position:fixed;
      left:50%;
      bottom: calc(14px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(10,14,22,.90);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(234,240,255,.95);
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: var(--shadow2);
      z-index:60;
      display:none;
      max-width: min(520px, 92vw);
      font-size: 12px;
    }
    .toast.show{ display:block; animation: pop .18s ease-out; }
    @keyframes pop{ from{ transform: translateX(-50%) translateY(6px); opacity:0 } to{ transform: translateX(-50%) translateY(0); opacity:1 } }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .logo:after{ animation:none }
      .toast.show{ animation:none }
    }
  </style>
</head>

<body>
<div class="wrap safe-top safe-bot">
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="brand-title">
          <b>CADRHUB</b>
          <small id="subline">Poster-menu ‚Ä¢ –≤—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º</small>
        </div>
      </div>

      <button class="icon-btn" id="btnStatus" type="button" title="–°—Ç–∞—Ç—É—Å">
        <span class="dot" id="dot"></span>
        <span id="statusText">TG</span>
      </button>

      <button class="icon-btn" id="btnClose" type="button" title="–ó–∞–∫—Ä—ã—Ç—å">
        ‚úï
      </button>
    </div>
  </div>

  <div class="hero">
    <div class="hero-card">
      <div class="hero-top">
        <span class="pill">‚ö° Studio Menu</span>
        <span class="pill" style="border-color:rgba(167,139,250,.45);background:rgba(167,139,250,.10)">üéõ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –ø–æ—Å—Ç–µ—Ä</span>
      </div>
      <h1>–°–æ–±–µ—Ä–∏ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–∞–∫–µ—Ç –∑–∞ 1 –º–∏–Ω—É—Ç—É</h1>
      <p>
        –¢—ã –≤—ã–±–∏—Ä–∞–µ—à—å —Ä–µ–∂–∏–º —Ç—É—Ç. –ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ –≤ —á–∞—Ç–µ, –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –µ—â—ë ‚Äú–≤–∞—É‚Äù –≤–∞—Ä–∏–∞–Ω—Ç—ã.
        <br/>–ù–∏–∫–∞–∫–∏—Ö ‚Äú–∑–∞–≥—Ä—É–∑–∏ –µ—â—ë —Ä–∞–∑‚Äù ‚Äî –≤—Å—ë –ø–æ —à–∞–≥–∞–º.
      </p>

      <div class="hero-actions">
        <button class="btn primary" id="btnHow" type="button">
          <span class="k">üß≠</span>
          <span><b>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</b><small>3 —à–∞–≥–∞, —á—Ç–æ–±—ã –Ω–µ –ø—É—Ç–∞—Ç—å—Å—è</small></span>
        </button>

        <button class="btn" id="btnSendHelp" type="button">
          <span class="k">üìé</span>
          <span><b>–ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ</b><small>–∫–∞—á–µ—Å—Ç–≤–æ / –¥–æ–∫—É–º–µ–Ω—Ç</small></span>
        </button>

        <button class="btn" id="btnCatalog" type="button">
          <span class="k">üß©</span>
          <span><b>–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å—ë</b><small>—Ä–µ–∂–∏–º—ã –∏ –ø–∞–∫–µ—Ç—ã</small></span>
        </button>
      </div>
    </div>
  </div>

  <div class="search">
    <div class="searchbox">
      <span style="opacity:.85">üîé</span>
      <input id="q" type="text" placeholder="–ü–æ–∏—Å–∫: –∫—Ä—É–∂–æ–∫, 9:16, –∫–æ–ª–ª–∞–∂, —ç–º–æ–¥–∑–∏‚Ä¶" autocomplete="off" />
      <span class="chip active" id="chipAll">–í—Å–µ</span>
      <span class="chip" id="chipVideo">–í–∏–¥–µ–æ</span>
      <span class="chip" id="chipGrid">–°–µ—Ç–∫–∏</span>
      <span class="chip" id="chipPost">–ü–æ—Å—Ç</span>
    </div>
  </div>

  <div class="content" id="content">

    <!-- SECTION: VIDEO -->
    <div class="section" data-section="video">
      <div class="section-head">
        <div>
          <h2>üé¨ –ò–∑ –≤–∏–¥–µ–æ</h2>
          <p>–ö—Ä—É–∂–∫–∏, –∞–≤–∞—Ç–∞—Ä—ã, —Ñ–æ—Ä–º–∞—Ç—ã, —ç—Ñ—Ñ–µ–∫—Ç—ã</p>
        </div>
        <div class="count" id="countVideo"></div>
      </div>

      <div class="grid" id="gridVideo"></div>
    </div>

    <!-- SECTION: GRIDS -->
    <div class="section" data-section="grid">
      <div class="section-head">
        <div>
          <h2>üß© –°–µ—Ç–∫–∏ / —ç–º–æ–¥–∑–∏-–≤–∏–¥–µ–æ</h2>
          <p>3√ó3, 20√ó1, random pack</p>
        </div>
        <div class="count" id="countGrid"></div>
      </div>

      <div class="grid" id="gridGrid"></div>
    </div>

    <!-- SECTION: COLLAGE -->
    <div class="section" data-section="collage">
      <div class="section-head">
        <div>
          <h2>üñº –ö–æ–ª–ª–∞–∂–∏</h2>
          <p>–ò–∑ —Ñ–æ—Ç–æ –∏–ª–∏ –∏–∑ –≤–∏–¥–µ–æ (–ª–∞–π—Ç–æ–≤–æ)</p>
        </div>
        <div class="count" id="countCollage"></div>
      </div>

      <div class="grid" id="gridCollage"></div>
    </div>

    <!-- SECTION: POSTS -->
    <div class="section" data-section="post">
      <div class="section-head">
        <div>
          <h2>‚úçÔ∏è –ü–æ—Å—Ç—ã / —Å—Ç–∏–ª–∏</h2>
          <p>–ü—Ä–∏–º–µ—Ä—ã –ø—Ä—è–º–æ –∫–∞–∫ –≤ Telegram</p>
        </div>
        <div class="count" id="countPost"></div>
      </div>

      <div class="grid" id="gridPost"></div>
    </div>

  </div>

  <div class="footer safe-bot">
    <div>
      <b>CADRHUB</b> ‚Ä¢ –≤—ã–±–∏—Ä–∞–µ—à—å —Ä–µ–∂–∏–º –∑–¥–µ—Å—å ‚Üí <b>–∑–∞–≥—Ä—É–∂–∞–µ—à—å –≤ —á–∞—Ç</b> ‚Üí –ø–æ–ª—É—á–∞–µ—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ ‚Äú–µ—â—ë‚Äù –ø–∞–∫–µ—Ç—ã.
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="sheet">
    <div class="sheet-head">
      <div>
        <h4 id="mTitle">–†–µ–∂–∏–º</h4>
        <p id="mDesc">–û–ø–∏—Å–∞–Ω–∏–µ</p>
      </div>
      <button class="icon-btn" id="mX" type="button" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
    </div>

    <div class="sheet-body">
      <div class="hint" id="mHint"></div>
      <div style="height:10px"></div>
      <div class="hint" id="mNext" style="border-color:rgba(122,162,255,.24); background:rgba(122,162,255,.06)">
        <b>–î–∞–ª—å—à–µ:</b> —è –æ—Ç–ø—Ä–∞–≤–ª—é –±–æ—Ç—É –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º. –ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –º–µ–¥–∏–∞ –≤ —á–∞—Ç–µ (–≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ) ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
      </div>
    </div>

    <div class="sheet-actions">
      <button class="btn good" id="mGo" type="button">
        <span class="k">‚úÖ</span>
        <span><b>–í—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º</b><small>–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç</small></span>
      </button>
      <button class="btn ghost" id="mStay" type="button">
        <span class="k">üëÄ</span>
        <span><b>–û—Å—Ç–∞—Ç—å—Å—è —Ç—É—Ç</b><small>–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ—â—ë</small></span>
      </button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
(function(){
  // --- Telegram WebApp bridge (safe) ---
  const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;

  function setStatus(){
    const dot = document.getElementById('dot');
    const statusText = document.getElementById('statusText');
    if(tg){
      statusText.textContent = 'TG';
      dot.style.background = 'var(--good)';
      try{
        tg.ready();
        tg.expand();
        // optional: themed header
        tg.setHeaderColor && tg.setHeaderColor('#0b0f18');
      }catch(e){}
    } else {
      statusText.textContent = 'WEB';
      dot.style.background = 'var(--warn)';
    }
  }

  function haptic(type){
    try{
      if(tg && tg.HapticFeedback){
        const HF = tg.HapticFeedback;
        if(type === 'light') HF.impactOccurred('light');
        else if(type === 'medium') HF.impactOccurred('medium');
        else if(type === 'heavy') HF.impactOccurred('heavy');
        else HF.notificationOccurred(type || 'success');
      }
    }catch(e){}
  }

  function toast(msg){
    const el = document.getElementById('toast');
    el.textContent = msg;
    el.classList.add('show');
    clearTimeout(el._t);
    el._t = setTimeout(()=> el.classList.remove('show'), 2200);
  }

  function sendPayload(payload){
    const str = JSON.stringify(payload);
    if(!tg){
      console.log('sendData:', str);
      toast('–û—Ç–∫—Ä—ã—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª—å');
      return true;
    }
    try{
      tg.sendData(str);
      return true;
    }catch(e){
      toast('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É');
      return false;
    }
  }

  // --- Data model for poster cards ---
  const MODES = [
    // VIDEO
    { id:'circle', section:'video', tag:'–í–∏–¥–µ–æ', icon:'‚óØ', title:'Fake Live (–∫—Ä—É–∂–æ–∫)', desc:'–ö—Ä—É–∂–æ–∫ ‚Äú–∫–∞–∫ –∂–∏–≤–æ–π‚Äù –∏–∑ —Ç–≤–æ–µ–≥–æ –≤–∏–¥–µ–æ', preview:'‚óØ + ‚úçÔ∏è', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ. –ü–æ—Å–ª–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –ø–æ–¥–ø–∏—Å—å/–ø–æ—Å—Ç.', needs:'video', badge:'top' },
    { id:'avatar', section:'video', tag:'–í–∏–¥–µ–æ', icon:'üë§', title:'Live Avatar', desc:'–í–∏–¥–µ–æ-–∞–≤–∞—Ç–∞—Ä–∫–∞: —á–∏—Å—Ç–æ, —Å—Ç–∏–ª—å–Ω–æ, –ø–µ—Ç–ª—è', preview:'üë§ loop', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ. –õ—É—á—à–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∫ –î–æ–∫—É–º–µ–Ω—Ç.', needs:'video', badge:'pro' },
    { id:'9_16', section:'video', tag:'–í–∏–¥–µ–æ', icon:'üì±', title:'9:16 (–≤–µ—Ä—Ç–∏–∫–∞–ª—å)', desc:'Reels/Shorts: –ø–æ–¥ –ª–µ–Ω—Ç—É –∏ —Å—Ç–æ—Ä–∏—Å', preview:'9:16', hint:'–ï—Å–ª–∏ –∫–∞–¥—Ä ‚Äú–¥–∞–ª–µ–∫–æ‚Äù ‚Äî –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º ‚Äú—Ä—É–ª—å‚Äù –∫–∞–¥—Ä–∞ (zoom/drag).', needs:'video' },
    { id:'16_9', section:'video', tag:'–í–∏–¥–µ–æ', icon:'üñ•', title:'16:9 (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å)', desc:'YouTube/–ø—Ä–µ–≤—å—é/—ç–∫—Ä–∞–Ω–Ω–∞—è –ø–æ–¥–∞—á–∞', preview:'16:9', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ. –î–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ ‚Äî –î–æ–∫—É–º–µ–Ω—Ç.', needs:'video' },
    { id:'fx_noir', section:'video', tag:'–í–∏–¥–µ–æ', icon:'üñ§', title:'Noir', desc:'–ß/–ë –≤–∏–Ω—Ç–∞–∂–Ω—ã–π —Å—Ç–∏–ª—å, –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω–æ', preview:'üñ§ + ‚úçÔ∏è', hint:'–ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ—Å—Ç –≤ —Å—Ç–∏–ª–µ Noir / Insider / POV.', needs:'video', badge:'style' },
    { id:'fx_boomerang', section:'video', tag:'–í–∏–¥–µ–æ', icon:'üîÅ', title:'Boomerang', desc:'–ü–µ—Ç–ª—è —Ç—É–¥–∞-–æ–±—Ä–∞—Ç–Ω–æ: —Ü–µ–ø–ª—è–µ—Ç –≤–∑–≥–ª—è–¥', preview:'üîÅ 2x', hint:'–û—Ç–ª–∏—á–Ω–æ –¥–ª—è ‚Äú–ø–µ—Ä–≤–æ–≥–æ –∫–∞—Å–∞–Ω–∏—è‚Äù –∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è.', needs:'video' },
    { id:'fx_audio', section:'video', tag:'–í–∏–¥–µ–æ', icon:'üéß', title:'Audio (mp3)', desc:'–í—ã—Ç—è–Ω—É—Ç—å –∑–≤—É–∫ –∏–∑ –≤–∏–¥–µ–æ (mp3)', preview:'mp3', hint:'–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ–∑–≤—É—á–∫–∏/–ø–æ–¥–∫–∞—Å—Ç-–Ω–∞—Ä–µ–∑–æ–∫.', needs:'video' },

    // GRID / EMOJI
    { id:'grid_3x3', section:'grid', tag:'–°–µ—Ç–∫–∏', icon:'üß©', title:'–°–µ—Ç–∫–∞ 3√ó3', desc:'–í–∏—Ä—É—Å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: —Å–µ—Ç–∫–∞ –∏–∑ –≤–∏–¥–µ–æ', preview:'3√ó3', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ. –†–µ–∂–µ–º –Ω–∞ 9 ‚Äú–∫—É—Å–æ—á–∫–æ–≤‚Äù.', needs:'video', badge:'viral' },
    { id:'grid_20x1', section:'grid', tag:'–°–µ—Ç–∫–∏', icon:'‚îÉ', title:'–õ–µ–Ω—Ç–∞ 20√ó1', desc:'–ü–æ–ª–æ—Å–∞ ‚Äú—Å—Ç–∏–∫–µ—Ä–æ–≤‚Äù (–∫–∞–∫ –Ω–∞–±–æ—Ä)', preview:'20√ó1', hint:'–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å—å+—ç–º–æ–¥–∑–∏+–ø–æ—Å—Ç –ø–∞–∫–µ—Ç–æ–º.', needs:'video', badge:'pack' },
    { id:'emoji_random_20', section:'grid', tag:'–°–µ—Ç–∫–∏', icon:'üé≤', title:'Random Emoji Pack', desc:'–°–ª—É—á–∞–π–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ 20 (–≤–∞—É-—ç—Ñ—Ñ–µ–∫—Ç)', preview:'üé≤‚Üíüß©', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ. –ú—ã —Å–æ–±–µ—Ä—ë–º ‚Äú—Ä–∞–Ω–¥–æ–º–Ω—ã–π‚Äù –Ω–∞–±–æ—Ä.', needs:'video', badge:'fun' },

    // COLLAGE
    { id:'collage_photo_2x2', section:'collage', tag:'–ö–æ–ª–ª–∞–∂', icon:'üñº', title:'–ö–æ–ª–ª–∞–∂ —Ñ–æ—Ç–æ 2√ó2', desc:'4 —Ñ–æ—Ç–æ ‚Üí –æ–¥–∏–Ω –∫–æ–ª–ª–∞–∂', preview:'2√ó2', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 4 —Ñ–æ—Ç–æ (–º–æ–∂–Ω–æ –∞–ª—å–±–æ–º–æ–º), –∑–∞—Ç–µ–º ‚Äú–ì–æ—Ç–æ–≤–æ‚Äù.', needs:'photos' },
    { id:'collage_photo_3x3', section:'collage', tag:'–ö–æ–ª–ª–∞–∂', icon:'üß±', title:'–ö–æ–ª–ª–∞–∂ —Ñ–æ—Ç–æ 3√ó3', desc:'9 —Ñ–æ—Ç–æ ‚Üí –æ–¥–∏–Ω –∫–æ–ª–ª–∞–∂', preview:'3√ó3', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –¥–æ 9 —Ñ–æ—Ç–æ (–∞–ª—å–±–æ–º–æ–º), –∑–∞—Ç–µ–º ‚Äú–ì–æ—Ç–æ–≤–æ‚Äù.', needs:'photos', badge:'viral' },
    { id:'collage_video_2x2', section:'collage', tag:'–ö–æ–ª–ª–∞–∂', icon:'üéû', title:'–ö–æ–ª–ª–∞–∂ –∏–∑ –≤–∏–¥–µ–æ', desc:'–û–¥–∏–Ω —Ä–æ–ª–∏–∫ ‚Üí 4 –∫–∞–¥—Ä–∞-–∫–æ–ª–ª–∞–∂–∞', preview:'üéû‚Üí2√ó2', hint:'–ë–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç 1 –≤–∏–¥–µ–æ. –ú—ã –≤–æ–∑—å–º—ë–º 4 —è—Ä–∫–∏—Ö –∫–∞–¥—Ä–∞.', needs:'video', badge:'smart' },

    // POST
    { id:'post_insider', section:'post', tag:'–ü–æ—Å—Ç', icon:'üïµÔ∏è', title:'–ü–æ—Å—Ç: INSIDER', desc:'–°–µ–∫—Ä–µ—Ç–Ω–æ, —É–≤–µ—Ä–µ–Ω–Ω–æ, –≤–æ–≤–ª–µ–∫–∞–µ—Ç', preview:'–∂–∏—Ä–Ω–æ+–∫—Ä—é—á–æ–∫', hint:'–ú–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ç—å —Ç–µ–∫—Å—Ç —Å—Ä–∞–∑—É (–±–µ–∑ –º–µ–¥–∏–∞) –∏–ª–∏ ‚Äú–ø–æ–¥ –≤–∞—à–µ –≤–∏–¥–µ–æ‚Äù –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∞.', needs:'text' },
    { id:'post_pov', section:'post', tag:'–ü–æ—Å—Ç', icon:'üé≠', title:'–ü–æ—Å—Ç: POV', desc:'–ö–æ—Ä–æ—Ç–∫–æ, –¥–µ—Ä–∑–∫–æ, —Ü–µ–ø–ª—è–µ—Ç', preview:'POV: ...', hint:'–ò–¥–µ–∞–ª—å–Ω–æ –≤ —Å–≤—è–∑–∫–µ —Å –∫—Ä—É–∂–∫–æ–º/—ç–º–æ–¥–∑–∏.', needs:'text' },
    { id:'post_old_money', section:'post', tag:'–ü–æ—Å—Ç', icon:'üíé', title:'–ü–æ—Å—Ç: OLD MONEY', desc:'–¢–∏—Ö–∞—è —Ä–æ—Å–∫–æ—à—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞', preview:'üíé —Å—Ç–∏–ª—å', hint:'–õ—É—á—à–µ –≤—Å–µ–≥–æ —Å Live Avatar/16:9.', needs:'text' },
    { id:'post_mix', section:'post', tag:'–ü–æ—Å—Ç', icon:'üß™', title:'–ú–∏–∫—Å 2 —Å—Ç–∏–ª–µ–π', desc:'–°–º–µ—à–∞—Ç—å –¥–≤–∞ —Å—Ç–∏–ª—è –≤ –æ–¥–∏–Ω –ø–æ—Å—Ç', preview:'A+B', hint:'–í—ã–±–µ—Ä–µ—à—å –¥–≤–∞ ‚Äî —è —Å–æ–±–µ—Ä—É –º–∏–∫—Å.', needs:'text', badge:'pro' },
    { id:'pack_boost', section:'post', tag:'–ü–∞–∫–µ—Ç—ã', icon:'‚ö°', title:'Boost Pack', desc:'–ö—Ä—É–∂–æ–∫ + –ø–æ—Å—Ç + 1 —ç–º–æ–¥–∑–∏', preview:'‚óØ+‚úçÔ∏è+üß©', hint:'–°–∏–ª—å–Ω—ã–π ‚Äú–ø–µ—Ä–≤—ã–π –∑–∞—Ö–æ–¥‚Äù + —É–¥–µ—Ä–∂–∞–Ω–∏–µ.', needs:'video', badge:'pack' },
    { id:'pack_creator', section:'post', tag:'–ü–∞–∫–µ—Ç—ã', icon:'üöÄ', title:'Creator Pack', desc:'9:16 + –æ–±–ª–æ–∂–∫–∞ + –ø–æ—Å—Ç', preview:'üì±+üñº+‚úçÔ∏è', hint:'–°–∞–º—ã–π ‚Äú–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π‚Äù –Ω–∞–±–æ—Ä –Ω–∞ –∑–∞–ø—É—Å–∫.', needs:'video', badge:'pack' },
  ];

  // --- Render cards ---
  const grids = {
    video: document.getElementById('gridVideo'),
    grid: document.getElementById('gridGrid'),
    collage: document.getElementById('gridCollage'),
    post: document.getElementById('gridPost'),
  };

  function badgeLabel(x){
    if(!x) return '';
    const map = {
      top:'TOP',
      pro:'PRO',
      viral:'VIRAL',
      style:'STYLE',
      pack:'PACK',
      fun:'FUN',
      smart:'SMART',
    };
    return map[x] || x.toUpperCase();
  }

  function makeCard(m){
    const el = document.createElement('div');
    el.className = 'card';
    el.dataset.id = m.id;
    el.dataset.section = m.section;
    el.dataset.tag = m.tag.toLowerCase();
    el.dataset.title = (m.title + ' ' + m.desc).toLowerCase();

    el.innerHTML = `
      <div class="row">
        <div class="ico">${m.icon}</div>
        <div class="badge">${badgeLabel(m.badge) || m.tag}</div>
      </div>
      <div>
        <h3>${m.title}</h3>
        <p>${m.desc}</p>
      </div>
      <div class="mini">
        <span>${m.needs === 'video' ? 'üé¨ –í–∏–¥–µ–æ' : m.needs === 'photos' ? 'üñº –§–æ—Ç–æ' : '‚úçÔ∏è –¢–µ–∫—Å—Ç'}</span>
        <code>${m.preview}</code>
      </div>
    `;
    el.addEventListener('click', ()=> openModal(m));
    return el;
  }

  function renderAll(){
    for(const k in grids) grids[k].innerHTML = '';
    let counts = {video:0, grid:0, collage:0, post:0};
    MODES.forEach(m=>{
      if(grids[m.section]){
        grids[m.section].appendChild(makeCard(m));
        counts[m.section]++;
      }
    });
    document.getElementById('countVideo').textContent = counts.video + ' —Ä–µ–∂–∏–º–æ–≤';
    document.getElementById('countGrid').textContent = counts.grid + ' —Ä–µ–∂–∏–º–æ–≤';
    document.getElementById('countCollage').textContent = counts.collage + ' —Ä–µ–∂–∏–º–æ–≤';
    document.getElementById('countPost').textContent = counts.post + ' —Ä–µ–∂–∏–º–æ–≤';
  }

  // --- Filter/search ---
  const q = document.getElementById('q');
  const chipAll = document.getElementById('chipAll');
  const chipVideo = document.getElementById('chipVideo');
  const chipGrid = document.getElementById('chipGrid');
  const chipPost = document.getElementById('chipPost');
  let chip = 'all';

  function setChip(which){
    chip = which;
    [chipAll, chipVideo, chipGrid, chipPost].forEach(c=>c.classList.remove('active'));
    if(which==='all') chipAll.classList.add('active');
    if(which==='video') chipVideo.classList.add('active');
    if(which==='grid') chipGrid.classList.add('active');
    if(which==='post') chipPost.classList.add('active');
    applyFilter();
    haptic('light');
  }
  chipAll.onclick = ()=> setChip('all');
  chipVideo.onclick = ()=> setChip('video');
  chipGrid.onclick = ()=> setChip('grid');
  chipPost.onclick = ()=> setChip('post');

  q.addEventListener('input', applyFilter);

  function applyFilter(){
    const term = (q.value || '').trim().toLowerCase();
    const cards = document.querySelectorAll('.card');
    cards.forEach(c=>{
      const section = c.dataset.section;
      const hay = c.dataset.title || '';
      const tag = c.dataset.tag || '';
      let ok = true;

      if(chip==='video') ok = section==='video';
      if(chip==='grid') ok = section==='grid';
      if(chip==='post') ok = section==='post';

      if(ok && term){
        ok = hay.includes(term) || tag.includes(term);
      }
      c.style.display = ok ? '' : 'none';
    });

    // hide empty sections
    document.querySelectorAll('.section').forEach(sec=>{
      const visible = sec.querySelectorAll('.card:not([style*="display: none"])').length;
      sec.style.display = visible ? '' : 'none';
    });
  }

  // --- Modal logic ---
  const modal = document.getElementById('modal');
  const mTitle = document.getElementById('mTitle');
  const mDesc = document.getElementById('mDesc');
  const mHint = document.getElementById('mHint');
  const mGo = document.getElementById('mGo');
  const mStay = document.getElementById('mStay');
  const mX = document.getElementById('mX');
  let current = null;

  function openModal(m){
    current = m;
    mTitle.textContent = m.title;
    mDesc.textContent = m.desc;

    const needsText = m.needs === 'video'
      ? '–ù—É–∂–Ω–æ: <b>1 –≤–∏–¥–µ–æ</b>. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ –≤–µ—Ä–Ω–∏—Å—å –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤—å –≤–∏–¥–µ–æ —Å–æ–æ–±—â–µ–Ω–∏–µ–º.'
      : m.needs === 'photos'
      ? '–ù—É–∂–Ω–æ: <b>–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ</b> (2‚Äì9). –û—Ç–ø—Ä–∞–≤–ª—è–π –∞–ª—å–±–æ–º–æ–º –≤ —á–∞—Ç, –ø–æ—Ç–æ–º –Ω–∞–∂–º–∏ ‚Äú–ì–æ—Ç–æ–≤–æ‚Äù.'
      : '–ù—É–∂–Ω–æ: <b>—Ç–µ–∫—Å—Ç</b>. –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –Ω–∞–ø–∏—Å–∞—Ç—å ‚Äî —è –æ—Ñ–æ—Ä–º–ª—é —Å—Ç–∏–ª–µ–º.';

    const quality = m.needs === 'video'
      ? '<br/><br/><b>–°–æ–≤–µ—Ç:</b> –æ—Ç–ø—Ä–∞–≤–ª—è–π –∫–∞–∫ <b>–î–æ–∫—É–º–µ–Ω—Ç</b>, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ.'
      : '';

    const template = `<b>–ü—Ä–µ–≤—å—é-—à–∞–±–ª–æ–Ω:</b> <code>${m.preview}</code><br/><br/>${needsText}${quality}<br/><br/><b>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</b> ${m.hint}`;

    mHint.innerHTML = template;

    modal.classList.add('show');
    haptic('medium');
  }

  function closeModal(){
    modal.classList.remove('show');
    current = null;
  }

  mX.onclick = closeModal;
  modal.addEventListener('click', (e)=>{
    if(e.target === modal) closeModal();
  });

  mStay.onclick = ()=>{
    haptic('light');
    closeModal();
  };

  mGo.onclick = ()=>{
    if(!current) return;
    haptic('success');

    // Payload for bot
    const payload = {
      type: 'pick_mode',
      mode: current.id,
      title: current.title,
      needs: current.needs
    };

    const ok = sendPayload(payload);

    // UX: show instruction and close
    if(ok){
      if(tg && tg.showPopup){
        try{
          tg.showPopup({
            title: '–†–µ–∂–∏–º –≤—ã–±—Ä–∞–Ω ‚úÖ',
            message: '–í–µ—Ä–Ω–∏—Å—å –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤—å –º–µ–¥–∏–∞. –ë–æ—Ç –Ω–∞—á–Ω—ë—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç ‚Äú–µ—â—ë‚Äù –ø–∞–∫–µ—Ç—ã.',
            buttons: [{type:'ok'}]
          }, ()=>{
            try{ tg.close(); }catch(e){}
          });
        }catch(e){
          toast('–†–µ–∂–∏–º –≤—ã–±—Ä–∞–Ω. –í–µ—Ä–Ω–∏—Å—å –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤—å –º–µ–¥–∏–∞.');
          try{ tg.close(); }catch(ex){}
        }
      } else {
        toast('–†–µ–∂–∏–º –≤—ã–±—Ä–∞–Ω. –í–µ—Ä–Ω–∏—Å—å –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤—å –º–µ–¥–∏–∞.');
      }
    }
    closeModal();
  };

  // --- Hero actions ---
  document.getElementById('btnHow').onclick = ()=>{
    haptic('light');
    const msg = [
      '–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç CADRHUB:',
      '1) –í—ã–±–∏—Ä–∞–µ—à—å —Ä–µ–∂–∏–º –∑–¥–µ—Å—å (Poster-menu)',
      '2) –í–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –≤ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ',
      '3) –ü–æ–ª—É—á–∞–µ—à—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç + –∫–Ω–æ–ø–∫–∏ ‚Äú—É—Å–∏–ª–∏—Ç—å‚Äù (–ø–∞–∫–µ—Ç—ã/–ø–æ—Å—Ç/—Å–µ—Ç–∫—É)'
    ].join('\n');
    if(tg && tg.showPopup){
      tg.showPopup({title:'3 —à–∞–≥–∞', message: msg, buttons:[{type:'ok'}]});
    } else toast('3 —à–∞–≥–∞: –≤—ã–±–µ—Ä–∏ ‚Üí –æ—Ç–ø—Ä–∞–≤—å –≤ —á–∞—Ç ‚Üí –ø–æ–ª—É—á–∏ + —É—Å–∏–ª–∏—Ç—å');
  };

  document.getElementById('btnSendHelp').onclick = ()=>{
    haptic('light');
    const msg = [
      '–ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏–¥–µ–æ:',
      '‚Ä¢ –í —á–∞—Ç –±–æ—Ç—É –æ—Ç–ø—Ä–∞–≤—å –≤–∏–¥–µ–æ.',
      '‚Ä¢ –î–ª—è –∫–∞—á–µ—Å—Ç–≤–∞: –æ—Ç–ø—Ä–∞–≤–ª—è–π –∫–∞–∫ –î–æ–∫—É–º–µ–Ω—Ç (—Ñ–∞–π–ª).',
      '‚Ä¢ –ï—Å–ª–∏ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ —Ä–∞–∑–º–µ—Ä—É ‚Äî —É–∫–æ—Ä–æ—Ç–∏/—Å–æ–∂–º–∏ (–∏–ª–∏ PRO).'
    ].join('\n');
    if(tg && tg.showPopup){
      tg.showPopup({title:'üìé –û—Ç–ø—Ä–∞–≤–∫–∞', message: msg, buttons:[{type:'ok'}]});
    } else toast('–°–æ–≤–µ—Ç: –≤–∏–¥–µ–æ –ª—É—á—à–µ –∫–∞–∫ –î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞');
  };

  document.getElementById('btnCatalog').onclick = ()=>{
    haptic('light');
    q.value = '';
    setChip('all');
    window.scrollTo({top: document.getElementById('content').offsetTop - 60, behavior:'smooth'});
  };

  // --- Topbar buttons ---
  document.getElementById('btnClose').onclick = ()=>{
    haptic('light');
    if(tg) { try{ tg.close(); }catch(e){} }
    else toast('–ó–∞–∫—Ä—ã—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram');
  };

  document.getElementById('btnStatus').onclick = ()=>{
    haptic('light');
    if(tg){
      toast('Telegram WebApp –∞–∫—Ç–∏–≤–µ–Ω ‚úÖ');
    } else {
      toast('–û—Ç–∫—Ä—ã—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (sendData –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è)');
    }
  };

  // init
  setStatus();
  renderAll();
  applyFilter();

})();
</script>
</body>
</html>
